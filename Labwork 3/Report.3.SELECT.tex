\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\title{Information System - Lab work 3}
\author{Tran Thi Hong Hanh}
\date{9 November 2017}

\begin{document}

\maketitle
\section*{Database}
\begin{itemize}
	\item employees (emp\_no, birth\_date, first\_name, last\_name, gender)
	\item departments (dept\_no, dept\_name)
	\item dept\_emp (emp\_no, dept\_no, from\_date, to\_date)
	\item dept\_manager (dept\_no, emp\_no, from\_date, to\_date)
	\item titles (emp\_no, title, from\_date, to\_date)
	\item salaries (emp\_no, salary, from\_date, to\_date)
\end{itemize}
\section*{Relational Algebra}
\begin{enumerate}
	\item All info of all employees.\\
	
	 SELECT * FROM employees;	
	
	\item All info of all departments.\\

	 SELECT * FROM departments;	
	
	\item Full names of all employees.\\
	
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\ FROM employees;
	
	\item Name of all departments\\
	
	SELECT dept\_name FROM departments;	
	
	\item Full names of employees working in "Sale" department.\\
	
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\
	FROM employees\\
	NATURAL JOIN departments\\ 
	NATURAL JOIN dept\_manager\\
	WHERE dept\_name ="sales"\\
	UNION \\
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\ 
	FROM employees\\ 
	NATURAL JOIN departments\\ 
	NATURAL JOIN dept\_emp\\
	WHERE dept\_name ="sales";
		
	\item Full names of male employees working in "Finance" department.\\
	
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\
	FROM employees\\
	NATURAL JOIN departments\\ 
	NATURAL JOIN dept\_manager\\
	WHERE dept\_name ="finance" and gender="M" \\
	UNION \\
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\ 
	FROM employees\\ 
	NATURAL JOIN departments\\ 
	NATURAL JOIN dept\_emp\\
	WHERE dept\_name ="finance" and gender="M" ;
	
	\item Salaries of female employees working in "Marketing" department.\\
	
	SELECT CONCAT (first\_name, " ", last\_name) AS full\_name, salary 
		FROM salaries NATURAL JOIN employees NATURAL JOIN departments
		WHERE gender="F" AND dept\_name="Marketing";
	
	\item Full names of employees who have the same last name as their manager.\\
	
		SELECT CONCAT ($R_{1}$.first\_name ," ", $R_{1}$.last\_name) as full\_name\\
		FROM (SELECT first\_name, last\_name, dept\_name FROM employees \\
		NATURAL JOIN (SELECT * FROM titles\\
		NATURAL JOIN departments\\
		NATURAL JOIN dept\_manager \\
		WHERE title='manager')AS sub\_query1) AS $R_{1}$\\
		JOIN\\
		(SELECT first\_name, last\_name, dept\_name FROM employees\\
	    NATURAL JOIN (SELECT* FROM titles\\
	    NATURAL JOIN departments\\
	    NATURAL JOIN dept\_emp \\
		WHERE title != 'manager') AS sub\_query2) AS $R_{2}$\\
		ON $R_{1}$.last\_name = $R_{2}$.last\_name and $R_{1}$.dept\_name = $R_{2}$.dept\_name; 	
		
	\item Full names of managers who have been doing the job at least twice.\\
	
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name\\
	FROM employees NATURAL JOIN dept\_manager
	GROUP BY emp\_no 
	HAVING count(emp\_no) $>$ 1;

	\item Full names of employees who was paid more than \$100000.\\
	
	SELECT CONCAT(first\_name, " ", last\_name) as full\_name, salary \\
	FROM employees	NATURAL JOIN salaries\\
	WHERE salary $>$ 100000;
	
	\item Names of all departments that have employees paid more than \$100000.\\

	SELECT dept\_name FROM dept\_emp\\
	NATURAL JOIN departments \\
	NATURAL JOIN salaries\\
	WHERE salary $>$ 100000\\
	UNION\\
	SELECT dept\_name FROM departments \\
	NATURAL JOIN salaries \\
	NATURAL JOIN dept\_manager\\
	WHERE salary $>$ 100000;\\
	
\end{enumerate}
\end{document}
